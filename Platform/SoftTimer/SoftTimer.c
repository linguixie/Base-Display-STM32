/*******************************************************************************
* Copyright (c) 2014,xxx公司
 *            All rights reserved.
* 程序名称：
* 版 本 号：1.0
* 开 发 人：谢林贵
* 开发时间：2014-05-24
* 修 改 者: 
* 修改时间: 
* 修改说明: 
* 其    他： 
********************************************************************************/
/*******************************************************************************
*                                    头  文  件
********************************************************************************/
#include "SoftTimer.h"



/*******************************************************************************
*                               文件内部使用宏定义
********************************************************************************/
 


/*******************************************************************************
*                                 全局函数(变量)声明
********************************************************************************/
volatile unsigned char F_Delay2MiliSec = 0;
volatile unsigned char F_Delay1Sec     = 0;
volatile unsigned char F_Delay1Min     = 0;


/*******************************************************************************
*                                 静态函数(变量)声明
********************************************************************************/
#define TimerNum    20
signed long *Timer[TimerNum];    //-注意最大延时时间-
signed long DummyTimer;



/*******************************************************************************
* 函数名称:    
* 函数功能:    
* 输入参数:    
* 输出参数:    无
* 返 回 值:    无
*******************************************************************************/
void InitTimer(void)
{
    int i = 0;

    for (i = 0; i < TimerNum; i++)
    {
        Timer[i] = &DummyTimer;
    }
}


/*******************************************************************************
* 函数名称:    
* 函数功能:    
* 输入参数:    
* 输出参数:    无
* 返 回 值:    无
*******************************************************************************/
unsigned char InsertTimer(signed long *Count)
{
    int i = 0;

    for (i = 0; i < TimerNum; i++)
    {
        if (Timer[i] == Count)
        {
            return 1;
        }
        if (Timer[i] == &DummyTimer)
        {
            Timer[i] = Count;
            return 1;
        }
    }

    return 0;
}
 

/*******************************************************************************
* 函数名称:    
* 函数功能:    
* 输入参数:    
* 输出参数:    无
* 返 回 值:    无
*******************************************************************************/
unsigned char DeleteTimer(signed long *Count)
{
    int i = 0;

    for (i = 0; i < TimerNum; i++)
    {
        if (Timer[i] == Count)
        {
            Timer[i] = &DummyTimer;
            return 1;
        }
    }

    return 0;
}


/*******************************************************************************
* 函数名称:    
* 函数功能:    
* 输入参数:    
* 输出参数:    无
* 返 回 值:    无
*******************************************************************************/
void TimerProcess(void)
{
    int i = 0;
    signed long *pTimer;

    for(i = 0; i < TimerNum; i++)
    {
        pTimer = Timer[i];
        if (pTimer != &DummyTimer)
        {
            if ((*pTimer) > 0)
            {
                (*pTimer)--;

                if (*pTimer == 0)
                {
                    (*pTimer)--;
                }
            }
        }
    }
}


/*******************************************************************************
* 函数名称:    
* 函数功能:    
* 输入参数:    
* 输出参数:    无
* 返 回 值:    无
* 其    他:    此函数如果在中断中调用,会增大中断负荷,故在主循环中调用
*******************************************************************************/
void Task_Timer(void)
{
}


/*************************************END OF FILE*******************************/



